$(function () { var e = document.getElementById("dna"), a = document.getElementById("search"), n = document.getElementById("span-groups"), t = $("#feedback"); if (dnaData = e ? e.dataset.result : "", spanGroups = n.checked, groupSize = 4, findMatches = function () { if (e && dnaData) { var n, r, c = new RegExp(a.value.toUpperCase(), "g"), d = a.value.length, s = []; if ($("#dna").find("span").removeClass("match"), t.text(""), t.removeClass("error"), console.log(validSearch()), validSearch()) { if (d > 1) { for (; n = null !== c.exec(dnaData) ;) { var l = c.lastIndex - d, o = l % groupSize == 0; (spanGroups || o) && s.push(l) } s.forEach(function (e) { for (var a = 0; d > a; a++) r = $("#dna").children(".base").eq(e + a), r.addClass("match") }), t.text(1 != s.length ? "Found " + s.length + " matches!" : "Found 1 match!") } } else t.text("Invalid search. Acceptable input is the letters A, C, G, and T."), t.addClass("error") } }, validSearch = function () { var e = a.value; return -1 != e.search(new RegExp("^[ACGTacgt]+$")) || 0 == e.length }, a.onkeyup = function () { findMatches() }, n.onclick = function () { spanGroups = n.checked, findMatches() }, e && dnaData) for (var r = 0; r < dnaData.length; r++) { var c = document.createElement("span"); if (c.className = "base", c.innerHTML = dnaData[r], r % groupSize == 0) { var d = document.createElement("span"); d.className = "separator", d.innerHTML = " ", e.appendChild(d) } e.appendChild(c) } });